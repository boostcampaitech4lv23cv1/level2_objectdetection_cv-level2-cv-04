#Backbone
##Faster R-CNN ì‹¤í—˜
###ResNet-50, ResNet-101, ResNeXt-101 backboneì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ ì‹¤í—˜
####ê°€ì„¤

Base model(Faster R-CNN, r50)ì˜ í‰ê°€ ì§€í‘œì—ì„œ train lossê°€ ìˆ˜ë ´ì„ í•˜ì˜€ìŒì—ë„ train mAPê°’ì´ ë‚®ì•„ underfittingì´ ì¼ì–´ë‚˜ê³  ìˆë‹¤ê³  íŒë‹¨, íŒŒë¼ë¯¸í„° ìˆ˜ê°€ ë” ë§ì€ ëª¨ë¸ì´ mAPë¥¼ ë†’ì—¬ì¤„ ê²ƒì´ë‹¤.

- mmdetectionì—ì„œ ì œê³µí•œ r50, r101, x101 ì„±ëŠ¥ ë¹„êµ ìë£Œ
    
    
    | Backbone | Lr schd | Mem (GB) | box AP |
    | --- | --- | --- | --- |
    | R-50-FPN | 1x | 4.0 | 37.4 |
    | R-50-FPN | 2x | - | 38.4 |
    | R-101-FPN | 1x | 6.0 | 39.4 |
    | R-101-FPN | 2x | - | 39.8 |
    | X-101-32x4d-FPN | 1x | 7.2 | 41.2 |
    | X-101-32x4d-FPN | 2x | - | 41.2 |
    
    ìš°ë¦¬ì˜ taskì—ì„œë„ ë¹„ìŠ·í•œ ì„±ëŠ¥ì„ ë³´ì´ì§€ ì•Šì„ê¹Œ?
    

####ì‹¤í—˜ ê²°ê³¼

![Untitled](images/Untitled%2012.png)

![Untitled](images/Untitled%2013.png)

| title | train loss | val mAP50 | TEST mAP |
| --- | --- | --- | --- |
| faster-rcnn_resnet50_fpn_sgd_512 | 0.3672 | 0.396 | 0.3929 |
| faster-rcnn_resnet101_fpn_sgd_512 | 0.3565 | 0.407 | 0.4189 |
| faster-rcnn_resnext101_fpn_sgd_512 |  | 0.439 | 0.4369 |

####ê²°ê³¼ ë¶„ì„

- ì˜ˆìƒëŒ€ë¡œ r50 < r101 < x101 ìˆœìœ¼ë¡œ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì¤¬ë‹¤.
- train loss ëŠ” 0.4~0.5 ì •ë„ë¥¼ ë§´ëŒë©° ë”ì´ìƒ ë‚´ë ¤ê°€ì§€ ì•Šì•˜ë‹¤.
- ResNeXt backboneì—ì„œ ì‚¬ìš©í•œ ê¸°ë²•ì´ ìš°ë¦¬ì˜ Taskë¥¼ ë” ì˜ í’€ì–´ë‚´ëŠ” ê²ƒìœ¼ë¡œ íŒë‹¨í–ˆë‹¤.
    
##Cascade R-CNN Backbone ì‹¤í—˜
####ê°€ì„¤
Faster R-CNN ì—ì„œì˜ Backbone ì‹¤í—˜ ê²°ê³¼ì™€ ë™ì¼í•˜ê²Œ r50 < r101 < x101 ìˆœìœ¼ë¡œ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì¤„ ê²ƒì´ë‹¤.

####ì‹¤í—˜ ê²°ê³¼

![Untitled](images/Untitled%2014.png)

![Untitled](images/Untitled%2015.png)


####ê²°ê³¼ ë¶„ì„
- train loss ì—ì„œ ë¯¸ì„¸í•˜ì§€ë§Œ ResNext-101 ëª¨ë¸ì´ ì„±ëŠ¥ì´ ì œì¼ ì¢‹ì•˜ë‹¤.
- validation ì§€í‘œì—ì„œë„ ì˜ˆìƒí–ˆë˜ëŒ€ë¡œ r50 < r101 < x101 ìˆœì˜ ì„±ëŠ¥ ì°¨ì´ë¥¼ ë³´ì˜€ë‹¤.
- mAP_s ì— ëŒ€í•œ ë‚´ìš©ì€ ëª¨ë¸ì´ í•™ìŠµì„ í†µí•´ ë§ì¶”ê¸°ì—ëŠ” ì‰½ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤.

##Backbone ëª¨ë¸ :  swin-T, swin-Lì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ ì‹¤í—˜
####ê°€ì„¤2  
ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê²°ê³¼ë¥¼ streamlitì„ ì´ìš©í•´ ì§ì ‘ ë³¸ ê²°ê³¼ classificationì„ ì œëŒ€ë¡œ í•˜ì§€ ëª»í•´, classificationì„±ëŠ¥ì´ ë” ì¢‹ì€ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë©´ mAPê°€ ì˜¤ë¥¼ ê²ƒìœ¼ë¡œ ì¶”ì¸¡í•¨.

####ì‹¤í—˜

- ResNetì— ë¹„í•´ classificationì„±ëŠ¥ì´ ì¢‹ì€ swin transformerê³„ì—´ì˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸°ë¡œ í•¨.
- swin-T, swin-L ëª¨ë¸ì˜ validation mAPë¹„êµ

ğŸ§‘ğŸ»â€ğŸ”¬ ì‹¤í—˜ ê²°ê³¼

| title | train loss | val mAP50 |
| --- | --- | --- |
| faster_rcnn_swint_fpn_sgd_512 | 0.4586 | 0.447 |
| faster_rcnn_swinl_fpn_sgd_512 | 0.4154 | 0.514 |

![51.PNG](images/51.png)

- ì‘ì€ ì‚¬ì´ì¦ˆì˜ bbox mAPê°’ì—ì„œ íŠ¹íˆ í° ì°¨ì´ë¥¼ ë³´ì—¬ì£¼ì—ˆê³ , ì „ë°˜ì ìœ¼ë¡œ ëª¨ë‘ mAPê°’ì´ ì˜¤ë¦„.

####ê²°ê³¼ ë¶„ì„

- ì‘ì€ ì‚¬ì´ì¦ˆì˜ bbox mAPê°’ì€ í˜„ì¬ 512ì‚¬ì´ì¦ˆë¡œ ì‹¤í—˜ í•˜ê³  ìˆìœ¼ë¯€ë¡œ 1024ë¡œ ë°”ê¾¼ë‹¤ë©´ ë” ì˜¤ë¥¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ê³ , neckì„ PAFPNìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤ë©´ ê° ì¸µì˜ featureë¥¼ í•œë²ˆ ë” ì„ì–´ì£¼ë¯€ë¡œ ë” ë†’ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì¤„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë¨.
- train lossëŠ” backboneì„ resnetìœ¼ë¡œ í–ˆì„ ë•Œ ë³´ë‹¤ ì˜¤íˆë ¤ ë” ë†’ì€ ê°’ì—ì„œ ìˆ˜ë ´í•¨. â†’ SGDë¡œëŠ” í˜„ì¬ì˜ local minimaì—ì„œ ë¹ ì ¸ë‚˜ì˜¬ ìˆ˜ ì—†ëŠ”ë“¯.